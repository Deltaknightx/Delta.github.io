/* quiz.js
   Externalized quiz logic for Milestone 3
   Keep this file in the same folder as quiz.html
*/

const answers = {
  q1: "application",
  q2: "GET",
  q3: "Persistent Connections",
  q4: "TLS",
  q5: ["Multiplexing", "Server Push"]
};

function gradeQuiz() {
  let score = 0;
  let feedbackHTML = "<h2>Quiz Results</h2>";

  // Q1 - fill in
  const q1 = document.getElementById("q1").value.trim().toLowerCase();
  if (q1 === answers.q1) { score++; feedbackHTML += success("1"); }
  else { feedbackHTML += fail("1", answers.q1); }

  // Q2 - radio
  const q2 = document.querySelector("input[name='q2']:checked");
  if (q2 && q2.value === answers.q2) { score++; feedbackHTML += success("2"); }
  else { feedbackHTML += fail("2", answers.q2); }

  // Q3 - radio
  const q3 = document.querySelector("input[name='q3']:checked");
  if (q3 && q3.value === answers.q3) { score++; feedbackHTML += success("3"); }
  else { feedbackHTML += fail("3", answers.q3); }

  // Q4 - radio
  const q4 = document.querySelector("input[name='q4']:checked");
  if (q4 && q4.value === answers.q4) { score++; feedbackHTML += success("4"); }
  else { feedbackHTML += fail("4", answers.q4); }

  // Q5 - checkboxes
  let q5Correct = 0;
  if (document.getElementById("q5a").checked) q5Correct++;
  if (document.getElementById("q5b").checked) q5Correct++;
  const q5Wrong = document.getElementById("q5c").checked || document.getElementById("q5d").checked;

  if (q5Correct === 2 && !q5Wrong) { score++; feedbackHTML += success("5"); }
  else { feedbackHTML += fail("5", "Multiplexing + Server Push"); }

  const passed = score >= 3;
  const resultsBox = document.getElementById("results");
  resultsBox.style.display = "block";
  resultsBox.className = "result-box " + (passed ? "score-pass" : "score-fail");

  resultsBox.innerHTML =
    `<p><strong>Final Score: ${score}/5</strong></p>` +
    `<p><strong>Result: ${passed ? "PASS" : "FAIL"}</strong></p>` +
    "<hr>" + feedbackHTML;
}

// small helper functions
function success(qNum) {
  return `<p class="answer-feedback correct">Question ${qNum}: Correct ✓</p>`;
}

function fail(qNum, correctAnswer) {
  return `<p class="answer-feedback incorrect">Question ${qNum}: Incorrect ✗ — Correct answer: ${correctAnswer}</p>`;
}

// reset function
function resetQuiz() {
  document.querySelectorAll("input").forEach(input => {
    if (input.type === "radio" || input.type === "checkbox") input.checked = false;
    else input.value = "";
  });
  const results = document.getElementById("results");
  results.style.display = "none";
  results.innerHTML = "";
}
